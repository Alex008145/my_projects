"use strict";(self.webpackChunkreact_complete_guide=self.webpackChunkreact_complete_guide||[]).push([[823],{429:(e,t,n)=>{n.d(t,{A:()=>a});var s=n(43);function o(e,t){return"SEND"===t.type?{data:null,error:null,status:"pending"}:"SUCCESS"===t.type?{data:t.responseData,error:null,status:"completed"}:"ERROR"===t.type?{data:null,error:t.errorMessage,status:"completed"}:e}const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[n,a]=(0,s.useReducer)(o,{status:t?"pending":null,data:null,error:null});return{sendRequest:(0,s.useCallback)((async function(t){a({type:"SEND"});try{const n=await e(t);a({type:"SUCCESS",responseData:n})}catch(n){a({type:"ERROR",errorMessage:n.message||"Something went wrong!"})}}),[e]),...n}}},980:(e,t,n)=>{n.d(t,{BC:()=>r,Ow:()=>d,dB:()=>o,kr:()=>c,zt:()=>a});const s="https://react-redux-cf72c-default-rtdb.europe-west1.firebasedatabase.app";async function o(){const e=await fetch("".concat(s,"/quotes.json")),t=await e.json();if(!e.ok)throw new Error(t.message||"Could not fetch quotes.");const n=[];for(const s in t){const e={id:s,...t[s]};n.push(e)}return n}async function a(e){const t=await fetch("".concat(s,"/quotes/").concat(e,".json")),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not fetch quote.");return{id:e,...n}}async function c(e){const t=await fetch("".concat(s,"/quotes.json"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not create quote.");return null}async function r(e){const t=await fetch("".concat(s,"/comments/").concat(e.quoteId,".json"),{method:"POST",body:JSON.stringify(e.commentData),headers:{"Content-Type":"application/json"}}),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not add comment.");return{commentId:n.name}}async function d(e){const t=await fetch("".concat(s,"/comments/").concat(e,".json")),n=await t.json();if(!t.ok)throw new Error(n.message||"Could not get comments.");const o=[];for(const s in n){const e={id:s,...n[s]};o.push(e)}return o}},823:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var s=n(43),o=n(688),a=n(582);const c="HighlightedQuote_quote__EauRS";var r=n(579);const d=e=>(0,r.jsxs)("figure",{className:c,children:[(0,r.jsx)("p",{children:e.text}),(0,r.jsx)("figcaption",{children:e.author})]}),m="Comments_comments__JaiQ-";var u=n(429),i=n(980);const l="NewCommentForm_form__4R-46",h="NewCommentForm_control__4xtgV",p="NewCommentForm_actions__iU-kM";var f=n(149);const j=e=>{const t=(0,s.useRef)(),{sendRequest:n,status:o,error:a}=(0,u.A)(i.BC),{onAddedComment:c}=e;(0,s.useEffect)((()=>{"completed"!==o||a||c()}),[o,a,c]);const d=s=>{s.preventDefault();const o=t.current.value;n({commentData:{text:o},quoteId:e.quoteId})};return(0,r.jsxs)("form",{className:l,onSubmit:d,children:["pending"===o&&(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(f.A,{})}),(0,r.jsxs)("div",{className:h,onSubmit:d,children:[(0,r.jsx)("label",{htmlFor:"comment",children:"Your Comment"}),(0,r.jsx)("textarea",{id:"comment",rows:"5",ref:t})]}),(0,r.jsx)("div",{className:p,children:(0,r.jsx)("button",{className:"btn",children:"Add Comment"})})]})},x="CommentItem_item__DENoO",w=e=>(0,r.jsx)("li",{className:x,children:(0,r.jsx)("p",{children:e.text})}),C="CommentsList_comments__Hi4fW",g=e=>(0,r.jsx)("ul",{className:C,children:e.comments.map((e=>(0,r.jsx)(w,{text:e.text},e.id)))}),N=()=>{const[e,t]=(0,s.useState)(!1),n=(0,o.useParams)(),{quoteId:a}=n,{sendRequest:c,status:d,data:l}=(0,u.A)(i.Ow);(0,s.useEffect)((()=>{c(a)}),[a,c]);const h=(0,s.useCallback)((()=>{c(a)}),[c,a]);let p;return"pending"===d&&(p=(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(f.A,{})})),"completed"===d&&l&&l.length>0&&(p=(0,r.jsx)(g,{comments:l})),"completed"!==d||l&&0!==l.length||(p=(0,r.jsx)("p",{className:"centered",children:"No comments were added yet!"})),(0,r.jsxs)("section",{className:m,children:[(0,r.jsx)("h2",{children:"User Comments"}),!e&&(0,r.jsx)("button",{className:"btn",onClick:()=>{t(!0)},children:"Add a Comment"}),e&&(0,r.jsx)(j,{quoteId:a,onAddedComment:h}),p]})},_=()=>{const e=(0,o.useRouteMatch)(),t=(0,o.useParams)(),{quoteId:n}=t,{sendRequest:c,status:m,data:l,error:h}=(0,u.A)(i.zt,!0);return(0,s.useEffect)((()=>{c(n)}),[c,n]),"pending"===m?(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(f.A,{})}):h?(0,r.jsx)("p",{className:"centered",children:h}):l.text?(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(d,{text:l.text,author:l.author}),(0,r.jsx)(o.Route,{path:e.path,exact:!0,children:(0,r.jsx)("div",{className:"centered",children:(0,r.jsx)(a.N_,{className:"btn--flat",to:"".concat(e.url,"/comments"),children:"Show Comments"})})}),(0,r.jsx)(o.Route,{path:"".concat(e.path,"/comments"),children:(0,r.jsx)(N,{})})]}):(0,r.jsx)("p",{children:"No quote found!"})}}}]);
//# sourceMappingURL=823.cedbe54f.chunk.js.map